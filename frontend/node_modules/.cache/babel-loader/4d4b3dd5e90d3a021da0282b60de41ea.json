{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\user\\\\Desktop\\\\m\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\user\\\\Desktop\\\\m\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\user\\\\Desktop\\\\m\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import Axios from'axios';import{Link,useParams}from'react-router-dom';import Container from'react-bootstrap/Container';import Form from'react-bootstrap/Form';import Button from'react-bootstrap/Button';import{Helmet}from'react-helmet-async';import{React,useState,useReducer}from'react';import'../index.css';import{getError}from'../utils';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'USER_RESET_PASSWORD_REQUEST':return{loading:true};case'USER_RESET_PASSWORD_SUCCESS':return{loading:false,message:action.payload.message};case'USER_RESET_PASSWORD_FAIL':return{loading:false,error:action.payload};default:return state;}};export default function ResetPasswordScreen(){var _useReducer=useReducer(reducer,{loading:false,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,message=_useReducer2$.message,error=_useReducer2$.error,dispatch=_useReducer2[1];var params=useParams();var token=params.token;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),password=_useState2[0],setPassword=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),confirmPassword=_useState4[0],setConfirmPassword=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),passwordErrorMessage=_useState6[0],setPasswordErrorMessage=_useState6[1];//const { state } = useContext(Store);\n//const { userInfo } = state; \nvar submitHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _yield$Axios$patch,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();dispatch({type:'USER_RESET_PASSWORD_REQUEST'});_context.prev=2;if(!(password!==confirmPassword)){_context.next=8;break;}setPasswordErrorMessage('Les mots de passe ne sont pas indentiques');dispatch({type:'USER_RESET_PASSWORD_FAIL',payload:getError(error)});_context.next=15;break;case 8:console.log(token);setPasswordErrorMessage(null);_context.next=12;return Axios.patch(\"/api/users/resetpassword/\".concat(token),{password:password});case 12:_yield$Axios$patch=_context.sent;data=_yield$Axios$patch.data;dispatch({type:'USER_RESET_PASSWORD_SUCCESS',payload:data});case 15:_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](2);dispatch({type:'USER_RESET_PASSWORD_FAIL',payload:getError(_context.t0)});case 20:case\"end\":return _context.stop();}}},_callee,null,[[2,17]]);}));return function submitHandler(_x){return _ref.apply(this,arguments);};}();function changeBackground(e){e.target.style.background='#121212';}function returnBackground(e){e.target.style.background='black';}return/*#__PURE__*/_jsxs(Container,{className:\"small-container\",children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:\"R\\xE9initialiser le mot de passe\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"h1\",children:\"R\\xE9initialiser le mot de passe\"}),passwordErrorMessage&&/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:passwordErrorMessage}),message&&/*#__PURE__*/_jsx(MessageBox,{variant:\"success\",children:message}),message&&/*#__PURE__*/_jsx(Link,{to:\"/signin\",children:\"Se connecter\"}),error&&/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:\"error\"}),loading&&/*#__PURE__*/_jsx(LoadingBox,{}),/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Nouveau mot de passe\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",required:true,onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",controlId:\"password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Comfirmer votre nouveau mot de passe\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",required:true,onChange:function onChange(e){return setConfirmPassword(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsx(Button,{onMouseOver:changeBackground,onMouseOut:returnBackground,className:\"btn1\",type:\"submit\",children:\"Enregistrer\"})})]})]});}","map":{"version":3,"sources":["C:/Users/user/Desktop/m/frontend/src/screens/ResetPasswordScreen.js"],"names":["Axios","Link","useParams","Container","Form","Button","Helmet","React","useState","useReducer","getError","LoadingBox","MessageBox","reducer","state","action","type","loading","message","payload","error","ResetPasswordScreen","dispatch","params","token","password","setPassword","confirmPassword","setConfirmPassword","passwordErrorMessage","setPasswordErrorMessage","submitHandler","e","preventDefault","console","log","patch","data","changeBackground","target","style","background","returnBackground","value"],"mappings":"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","sourcesContent":["import Axios from 'axios';\nimport { Link, useParams } from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport { Helmet } from 'react-helmet-async';\nimport { React, useState, useReducer  } from 'react';\nimport '../index.css';\nimport { getError } from '../utils';\nimport LoadingBox from '../components/LoadingBox';\nimport MessageBox from '../components/MessageBox';\n\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'USER_RESET_PASSWORD_REQUEST':\n      return { loading: true };\n  \n    case 'USER_RESET_PASSWORD_SUCCESS':\n      return { loading: false, message: action.payload.message };\n  \n    case 'USER_RESET_PASSWORD_FAIL':\n      return { loading: false, error: action.payload };\n    default:\n      return state;\n  }\n};\n\nexport default function ResetPasswordScreen() {\n\n  const [{ loading, message ,error}, dispatch] =\n  useReducer(reducer, {\n    loading: false,\n    error: '',\n\n  });\n \n  const params = useParams(); \n  const { token } = params;\n  \n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [passwordErrorMessage, setPasswordErrorMessage] = useState(null)\n\n  //const { state } = useContext(Store);\n  //const { userInfo } = state; \n\n  const submitHandler = async (e) => {\n    e.preventDefault();\n\n     dispatch({ type: 'USER_RESET_PASSWORD_REQUEST' });\n    try {\n      if (password !== confirmPassword) {\n        setPasswordErrorMessage('Les mots de passe ne sont pas indentiques');\n        dispatch({\n          type: 'USER_RESET_PASSWORD_FAIL',\n          payload: getError(error),\n        });\n      }\n      else {\n      console.log(token);\n      setPasswordErrorMessage(null)\n      const { data } = await Axios.patch(`/api/users/resetpassword/${token}`, { password },);\n      dispatch({ type: 'USER_RESET_PASSWORD_SUCCESS', payload: data });\n      \n    }\n      } catch (err) {\n      dispatch({\n        type: 'USER_RESET_PASSWORD_FAIL',\n        payload: getError(err),\n      });     \n    }\n  };\n\n  function changeBackground(e) {\n    e.target.style.background = '#121212';\n  }\n\n  function returnBackground(e) {\n    e.target.style.background = 'black';\n  }\n\n  return (\n    <Container className=\"small-container\">\n      <Helmet>\n        <title>Réinitialiser le mot de passe</title>\n      </Helmet>\n      <h1 className=\"h1\">Réinitialiser le mot de passe</h1>\n\n      {passwordErrorMessage && (\n        <MessageBox variant=\"danger\">{passwordErrorMessage}</MessageBox>\n      )}\n      {message && <MessageBox variant=\"success\">{message}</MessageBox>}\n      {message && <Link to=\"/signin\">Se connecter</Link>}\n      {error && <MessageBox variant=\"danger\">error</MessageBox>}\n      {loading && <LoadingBox />}\n\n      <Form onSubmit={submitHandler}>\n        <Form.Group className=\"mb-3\" controlId=\"email\">\n          <Form.Label>Nouveau mot de passe</Form.Label>\n          <Form.Control\n            type=\"password\"\n            required\n            onChange={(e) => setPassword(e.target.value)}\n          />\n        </Form.Group>\n        <Form.Group className=\"mb-3\" controlId=\"password\">\n          <Form.Label>Comfirmer votre nouveau mot de passe</Form.Label>\n          <Form.Control\n            type=\"text\"\n            required\n            onChange={(e) => setConfirmPassword(e.target.value)}\n          />\n        </Form.Group>\n        <div className=\"mb-3\">\n          <Button onMouseOver={changeBackground} onMouseOut={returnBackground}  className='btn1' type=\"submit\">Enregistrer</Button>\n        </div>\n      </Form>\n    </Container>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}